{"id":3963,"date":"2025-01-02T00:21:29","date_gmt":"2025-01-02T00:21:29","guid":{"rendered":"http:\/\/programming.team2102.org\/?page_id=3963"},"modified":"2025-01-11T02:22:04","modified_gmt":"2025-01-11T02:22:04","slug":"testing-the-wiring-2","status":"publish","type":"page","link":"http:\/\/gabybot.com\/testing-the-wiring-2\/","title":{"rendered":"Testing The Wiring"},"content":{"rendered":"\n<p>We will now perform a series of tests to make sure we have wired the robot correctly.<\/p>\n\n\n\n<p>First you need to load and run the <strong>SwerveBotWiringTest<\/strong> project that you can find in the <strong>VSCode <\/strong>folder of <strong>RobotTools2024<\/strong>.<\/p>\n\n\n\n<p>If you are unfamiliar with how to run programs on the robot, refer to this section of the <a href=\"http:\/\/programming.team2102.org\/running-the-program\/\" data-type=\"page\" data-id=\"65\" target=\"_blank\" rel=\"noreferrer noopener\">Minibot Tutorial<\/a>.<\/p>\n\n\n\n<h4>Swerve Motor Testing<\/h4>\n\n\n\n<p>To test the <strong>Steering Motors<\/strong> either prop the robot off it&#8217;s wheels or turn it upside down. Then run the <strong>SwerveBotWiringTest<\/strong> project and the press the <strong>B1<\/strong> button from the <strong>Driver Station<\/strong> (don&#8217;t forget to <strong>Connect <\/strong>and <strong>Enable <\/strong>first). When you do this the four <strong>Steering Motors<\/strong> should run in sequence in the order <strong>Front Left<\/strong>, <strong>Back Left<\/strong>, <strong>Back Right<\/strong> and <strong>Front Right<\/strong>. You should ensure that each motor runs a the correct time. If the run out of order then you need to check the motor connections to the <strong>Microcontrollers<\/strong>. <\/p>\n\n\n\n<p>If the <strong>Drive <\/strong>motor runs instead of the <strong>Steering <\/strong>motor this means that you have the connection to the <strong>Motor Controller<\/strong> reversed and you need to switch it as shown:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-full is-resized\"><a href=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/FixMotorConnection.jpg\"><img loading=\"lazy\" src=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/FixMotorConnection.jpg\" alt=\"\" class=\"wp-image-4078\" width=\"311\" height=\"215\" srcset=\"http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/FixMotorConnection.jpg 568w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/FixMotorConnection-300x208.jpg 300w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/FixMotorConnection-150x104.jpg 150w\" sizes=\"(max-width: 311px) 100vw, 311px\" \/><\/a><\/figure><\/div>\n\n\n\n<p>Then check that all of the wheels are turning <strong>counter clockwise<\/strong> when viewed from the <strong>top <\/strong>(<strong>clockwise <\/strong>when viewed from the <strong>bottom<\/strong>). If any motor is turning the wrong direction it means that you have the power connection to the motor controller reversed. You can fix it by switching the power connection as shown below (preferred), or if you like you can fix it in software by calling the <a href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_smart_motor.html#a1880600586c2d55a8acd9d2b13d13097\" target=\"_blank\" rel=\"noreferrer noopener\">setInverted<\/a> function for that motor.<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-full is-resized\"><a href=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/SwapPower.jpg\"><img loading=\"lazy\" src=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/SwapPower.jpg\" alt=\"\" class=\"wp-image-4080\" width=\"304\" height=\"210\" srcset=\"http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SwapPower.jpg 568w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SwapPower-300x208.jpg 300w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SwapPower-150x104.jpg 150w\" sizes=\"(max-width: 304px) 100vw, 304px\" \/><\/a><\/figure><\/div>\n\n\n\n<p>Finally you need to make sure that all of the <strong>Steering Encoders <\/strong>are working. When the command runs the position for all of the <strong>Steering Encoders<\/strong> will be printed into the <strong>Terminal Window<\/strong>. Make sure that the encoder that changes corresponds to the current motor running. If it is wrong then you need to check the encoder connections to the <strong>Microcontrollers<\/strong>. Also, when the motor runs these numbers should always be <strong>increasing<\/strong>. The easiest way to see this is to copy the data and paste it into your favorite spreadsheet and graph it. When I do this for my robot I get the following graph:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-full is-resized\"><a href=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/SteeringTest.jpg\"><img loading=\"lazy\" src=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/SteeringTest.jpg\" alt=\"\" class=\"wp-image-4067\" width=\"459\" height=\"256\" srcset=\"http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SteeringTest.jpg 754w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SteeringTest-300x167.jpg 300w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/SteeringTest-150x84.jpg 150w\" sizes=\"(max-width: 459px) 100vw, 459px\" \/><\/a><\/figure><\/div>\n\n\n\n<p>Note here that the all of the graphs have a <strong>positive slope<\/strong> and that the <strong>Front Left<\/strong> moves first followed by the <strong>Back Left<\/strong>, <strong>Back Right<\/strong> and <strong>Front Right<\/strong>. There should be no way that the slopes are negative unless you somehow installed the encoder upside down.<\/p>\n\n\n\n<h4>Drive Motor Testing<\/h4>\n\n\n\n<p>Once again either prop up the robot or turn it upside down. Then run the <strong>SwerveBotWiringTest <\/strong>project and run the <strong>Drive Motor Test<\/strong> by clicking the <strong>B2 <\/strong>button (after connecting and enabling of course). As with the <strong>Swerve Motor Test<\/strong> each of the four motors will run one at a time in the order, <strong>Front Left<\/strong>, <strong>Back Left<\/strong>, <strong>Back Right<\/strong> and <strong>Front Right<\/strong>.<\/p>\n\n\n\n<p>You should make sure that the correct motor runs at the correct time. If this is not the case then you should check your <strong>Drive Motor<\/strong> connections on the <strong>Microcontrollers<\/strong>. Note that since the <strong>Swerve <\/strong>and <strong>Drive <\/strong>motors are connected to the same <strong>Motor Controller<\/strong> if you fixed this for the <strong>Swerve Motors<\/strong> this should work for the <strong>Drive Motors<\/strong>.<\/p>\n\n\n\n<p>Also make sure that the wheel is rotating in a clockwise direction when view for the side with the gear as shown below:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-full is-resized\"><a href=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection.jpg\"><img loading=\"lazy\" src=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection.jpg\" alt=\"\" class=\"wp-image-4072\" width=\"318\" height=\"275\" srcset=\"http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection.jpg 1024w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection-300x260.jpg 300w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection-150x130.jpg 150w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveTestRotationDirection-768x665.jpg 768w\" sizes=\"(max-width: 318px) 100vw, 318px\" \/><\/a><\/figure><\/div>\n\n\n\n<p>If the motor rotates the wrong direction you can either swap the power connection on the <strong>Motor Controller<\/strong> as described above (preferred) or use the <a href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_smart_motor.html#a1880600586c2d55a8acd9d2b13d13097\" target=\"_blank\" rel=\"noreferrer noopener\">setInverted<\/a> function for the motor.<\/p>\n\n\n\n<p>Finally you need to make sure that the encoders connected correctly and are counting the correct direction. The speed of each of the wheels is printed out in the <strong>Terminal <\/strong>window. Once again you can plot the data and you should get something like:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-full is-resized\"><img loading=\"lazy\" src=\"http:\/\/programming.team2102.org\/wp-content\/uploads\/2025\/01\/DriveSpeeds.jpg\" alt=\"\" class=\"wp-image-4084\" width=\"440\" height=\"253\" srcset=\"http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveSpeeds.jpg 750w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveSpeeds-300x172.jpg 300w, http:\/\/gabybot.com\/wp-content\/uploads\/2025\/01\/DriveSpeeds-150x86.jpg 150w\" sizes=\"(max-width: 440px) 100vw, 440px\" \/><\/figure><\/div>\n\n\n\n<p>First make sure that the encoders are associated with the correct wheel. Here we can see that the <strong>Front Left<\/strong> motor runs followed by the <strong>Back Left<\/strong>, <strong>Back Right<\/strong> and <strong>Front Right<\/strong>. If the wrong encoder is being used for any of the motors you must have the <strong>Encoder <\/strong>connection on the <strong>Microcontrollers <\/strong>incorrect.<\/p>\n\n\n\n<p>Finally the speed for all of the wheels should be <strong>positive<\/strong>. If the wheel is rotating the correct direction but the speed is showing <strong>negative <\/strong>them you connected the<strong> A\/B<\/strong> connections reversed when you make the connecting cable. To fix this you can reverse the connections on the connector but it is actually quite difficult (but not impossible) to remove the connectors once they have been inserted into the housing. The other alternative is to use the <a rel=\"noreferrer noopener\" href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_encoder.html#ab0c5ccc191aea51f930b201bad153964\" target=\"_blank\">setInverted<\/a> function for the encoder. If you go this route you will need to remember the this will need to be done by every student working through the tutorial.<\/p>\n\n\n\n<h4>Feeder Testing<\/h4>\n\n\n\n<p>To test the <strong>Feeder Motor<\/strong>, press the <strong>B3<\/strong> button on the <strong>Driver Station<\/strong> which should toggle the <strong>Feeder Motor<\/strong> in the forward direction.<\/p>\n\n\n\n<p> If it runs the wrong way, either swap the feeder power connection on the <strong>Motor Controller<\/strong> or use the <a rel=\"noreferrer noopener\" href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_smart_motor.html#a1880600586c2d55a8acd9d2b13d13097\" target=\"_blank\">setInverted<\/a> function on the motor. Also the speed of the feeder motor will be printed to the <strong>Terminal Window<\/strong>. Make sure that this value is not zero. The sign for this encoder is not important as we will only be using it&#8217;s magnitude to detect whether the feeder has stalled as a result of a ball jam.<\/p>\n\n\n\n<h4>Shooter Testing<\/h4>\n\n\n\n<p>To test the <strong>Shooter Motor<\/strong>, press the <strong>B4 <\/strong>button on the <strong>Driver Station<\/strong> which should toggle the <strong>Shooter Motor<\/strong> in the forward (counter clockwise when viewed from the side). Again if the motor runs backwards either swap the power connection or use <a href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_smart_motor.html#a1880600586c2d55a8acd9d2b13d13097\" target=\"_blank\" rel=\"noreferrer noopener\">setInverted<\/a>.<\/p>\n\n\n\n<p>The speed is printed to the <strong>Terminal Window<\/strong>. Make sure that the speed is positive. If it is negative (and the <strong>Shooter <\/strong>is running the correct direction) you will either need to swap the <strong>A\/B<\/strong> lines on the encoder connector (hard) or use the <a rel=\"noreferrer noopener\" href=\"http:\/\/programming.team2102.org\/RobotCoreDoc\/classrobot_core_1_1_smart_motor.html#a1880600586c2d55a8acd9d2b13d13097\" target=\"_blank\">setInverted<\/a> on the Encoder.<\/p>\n\n\n\n<h4>Ball Counter Testing<\/h4>\n\n\n\n<p>To test the <strong>Ball Counter<\/strong>, press the <strong>B5<\/strong> button on the <strong>Driver Station<\/strong>. While this is active, the ball count will be printed to the <strong>Terminal Window.<\/strong> Use your finger to break the beam and see if the counter increments. Remember that the counter counts both when the beam is broken and when it is resorted so you will get a count of two each time you break the beam. If the counter is not working check the wiring for both the <strong>Sensor <\/strong>and the <strong>LED<\/strong>.<\/p>\n\n\n\n<h4>Camera Testing<\/h4>\n\n\n\n<p>To test the Camera Connection, bring up a command prompt and type<\/p>\n\n\n\n<p>ssh pi@10.21.2.2<\/p>\n\n\n\n<p>to open a secure shell to the Raspberry Pi. The password is raspberry. Then enter<\/p>\n\n\n\n<p>.\/runcamera<\/p>\n\n\n\n<p>to start the camera server. If the camera is working you will see something like this<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>&#91;0:03:04.828733407] &#91;819]  INFO RPI vc4.cpp:444 Registered camera \/base\/soc\/i2c0mux\/i2c@1\/ov5647@36 to Unicam device \/dev\/media4 and ISP device \/dev\/media1\n - ov5647\n1 Streams:\n0: width=800, height=600\n&#91;0:03:04.829350253] &#91;813]  INFO Camera camera.cpp:1183 configuring streams: (0) 640x480-RGB888\n&#91;0:03:04.829745818] &#91;819]  INFO RPI vc4.cpp:608 Sensor: \/base\/soc\/i2c0mux\/i2c@1\/ov5647@36 - Selected sensor format: 640x480-SGBRG10_1X10 - Selected unicam format: 640x480-pGAA\nWidth=640,Height=480,Stride=1920\nDefault viewfinder configuration is: 640x480-RGB888\nValidated viewfinder configuration is: 640x480-RGB888\n&#91;0:03:04.831106483] &#91;813]  INFO Camera camera.cpp:1183 configuring streams: (0) 640x480-RGB888\n&#91;0:03:04.833013222] &#91;819]  INFO RPI vc4.cpp:608 Sensor: \/base\/soc\/i2c0mux\/i2c@1\/ov5647@36 - Selected sensor format: 640x480-SGBRG10_1X10 - Selected unicam format: 640x480-pGAA\nStartCapture\nNormal Settings\nProcessStart\ndec=4.000000,sig=1.000000,nth=4,refe=1\n0: FPS = 29.72, GPS = 490703133.33, proc = 100, grabbed = 1651076242, dt=3.364715\nImageProcessingServer started\nImageServer started\nWaiting for processing connection\n0: FPS = 31.77, GPS = 31.77, proc = 100, grabbed = 100, dt=3.147718\n0: FPS = 31.86, GPS = 31.86, proc = 100, grabbed = 100, dt=3.138413\nWaiting for image connection\n0: FPS = 31.86, GPS = 31.86, proc = 100, grabbed = 100, dt=3.138721<\/code><\/pre>\n\n\n\n<p>If the camera initialization fails, you will see something like:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>Lens for camera 0: Pi Camera 640x480\r\nShutter Speed = 20, Exposure = 0, Frame Rate = 50\r\nnewShutterSpeed=20\r\nShutterspeed = 20\r\nnewExposure=0.000000\r\nExposure = 0\r\nnewFrameRate=30\r\nFrame rate = 30\r\nwhiteCnt = 3\r\nMinSize = 20\r\nWhiteDrop = 80\r\nMinBlack = 16\r\nMaxSlope = 0.300000\r\nMaxParallel = 0.150000\r\nMaxAspect = 1.300000\r\nMaxAspect = 0.700000\r\nnewBrightness=0\r\nDecimate = 4.000000\r\nnewContrast=100\r\ncontrast=100\r\nStartCapture\r\n&#91;0:00:55.460738689] &#91;931]  INFO Camera camera_manager.cpp:284 libcamera v0.1.0+118-563cd78e\r\n&#91;0:00:55.483170392] &#91;931]  INFO Camera camera_manager.cpp:284 libcamera v0.1.0+118-563cd78e\r\nNo cameras were identified on the system.\r\nCannot initialize camera<\/code><\/pre>\n\n\n\n<p>In that case you need to check your camera cable connection.<\/p>\n\n\n\n<p>Congratulations your robot is now ready for use!<\/p>\n","protected":false},"excerpt":{"rendered":"<p>We will now perform a series of tests to make sure we have wired the robot correctly. First you need to load and run the SwerveBotWiringTest project that you can find in the VSCode folder of RobotTools2024. If you are unfamiliar with how to run programs on the robot, refer to this section of the&hellip;&nbsp;<a href=\"http:\/\/gabybot.com\/testing-the-wiring-2\/\" class=\"\" rel=\"bookmark\">Read More &raquo;<span class=\"screen-reader-text\">Testing The Wiring<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"open","template":"","meta":{"neve_meta_sidebar":"","neve_meta_container":"","neve_meta_enable_content_width":"","neve_meta_content_width":0,"neve_meta_title_alignment":"","neve_meta_author_avatar":"","neve_post_elements_order":"","neve_meta_disable_header":"","neve_meta_disable_footer":"","neve_meta_disable_title":""},"_links":{"self":[{"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/pages\/3963"}],"collection":[{"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/comments?post=3963"}],"version-history":[{"count":19,"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/pages\/3963\/revisions"}],"predecessor-version":[{"id":4099,"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/pages\/3963\/revisions\/4099"}],"wp:attachment":[{"href":"http:\/\/gabybot.com\/wp-json\/wp\/v2\/media?parent=3963"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}